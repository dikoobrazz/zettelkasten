2025032715:01
___
Date: 27-03-2025 | 15:01
Tags: #
mapofcontents: [[zero-links|OO Links]]
___
## Примитивные и ссылочные типы в Java
> В Java типы данных делятся на две основные категории: **примитивные** (primitive types) и **ссылочные** (reference types). Они отличаются по своей природе, способу хранения в памяти и использованию.

---
### Примитивные типы

> **Примитивные типы** — это базовые строительные блоки в Java, которые представляют собой простые значения, не являющиеся объектами. Их всего 8:

1. **byte** (8 бит, -128 до 127)
2. **short** (16 бит, -32,768 до 32,767)
3. **int** (32 бита, -2^31 до 2^31-1)
4. **long** (64 бита, -2^63 до 2^63-1)
5. **float** (32 бита, с плавающей точкой, IEEE 754)
6. **double** (64 бита, с плавающей точкой, IEEE 754)
7. **char** (16 бит, символ Unicode, 0 до 65,535)
8. **boolean** (логический тип, true/false; размер зависит от JVM, обычно 1 бит)
#### Хранение в памяти

- Примитивные типы хранятся **непосредственно в стеке (stack)**, если они являются локальными переменными метода. **Стек** — это область памяти, которая управляется автоматически и используется для хранения данных с фиксированным временем жизни (например, переменных внутри метода).
- Значение примитивного типа — это само число, символ или логическое значение, без дополнительных метаданных. Например, если вы объявляете `int x = 5;`, в стеке выделяется 32 бита, и там записывается значение 5.
- Если примитивная переменная является полем класса (instance variable), она хранится в **куче (heap)** как часть объекта, но всё равно представляет собой само значение, а не ссылку.
#### Особенности

- Примитивы не могут быть `null`, так как они не являются объектами.
- Их размер фиксирован и зависит от типа (например, `int` всегда 4 байта).
- При передаче в метод они копируются по значению (pass-by-value), то есть изменения внутри метода не влияют на оригинал.

---
### Ссылочные типы

> **Ссылочные типы** — это все остальные типы данных в Java, которые представляют собой объекты или массивы. Они включают:

- Классы (например, `String`, `Integer`, пользовательские классы)
- Интерфейсы
- Массивы (например, `int[]`, `String[]`)
- Перечисления (enum)
#### Хранение в памяти

- Ссылочные типы хранятся в **куче (heap)**, которая предназначена для динамически выделяемых объектов с неопределённым временем жизни. Куча управляется сборщиком мусора (Garbage Collector).
- Переменная ссылочного типа содержит не сам объект, а **ссылку** (адрес в памяти) на объект в куче. Эта ссылка обычно занимает 32 или 64 бита (зависит от архитектуры JVM).
- Сама ссылка, если это локальная переменная, хранится в **стеке**, а объект, на который она указывает, — в **куче**. Например:
```java
String s = "Hello";
```

- Здесь `s` — это ссылка в стеке, а строка `"Hello"` — объект в куче (хотя строки в Java также кэшируются в пуле строк, но об этом позже).
#### Структура объекта в куче

Объект в куче состоит из:

1. **Заголовок** (header): содержит метаданные, такие как тип объекта и информация для сборщика мусора (обычно 8-16 байт).
2. **Поля объекта**: значения примитивных полей или ссылки на другие объекты.
3. Выравнивание (padding), если требуется для оптимизации.

Пример:
```java
class Person {
    int age = 25;         // Примитивное поле
    String name = "Alex"; // Ссылочное поле
}
Person p = new Person();
```

- `p` — ссылка в стеке.
- Объект `Person` в куче содержит:
    - `age` (4 байта, значение 25),
    - `name` (ссылка на объект `String` в куче).
#### Особенности

- Ссылочные типы могут быть `null`, что означает отсутствие объекта.
- При передаче в метод передаётся копия ссылки (pass-by-value), но сам объект остаётся тем же, поэтому изменения его полей видны снаружи.
- Размер объекта в куче зависит от его структуры (полей) и может быть динамическим (например, для массивов).

---
### Сравнение хранения

| **Характеристика**        | **Примитивные типы**                     | **Ссылочные типы**            |
| ------------------------- | ---------------------------------------- | ----------------------------- |
| **Место хранения**        | Стек (локальные) или куча (поля объекта) | Ссылка в стеке, объект в куче |
| **Содержимое переменной** | Само значение                            | Адрес объекта                 |
| **Размер**                | Фиксирован (например, 4 байта для int)   | Зависит от объекта            |
| **Может быть null?**      | Нет                                      | Да                            |
| **Передача в метод**      | Копия значения                           | Копия ссылки                  |

---
##### Пример в коде
```java
public class Example {
    public static void main(String[] args) {
        int primitive = 10;           // В стеке
        String reference = "Test";    // Ссылка в стеке, объект в куче
        int[] array = new int[3];     // Ссылка в стеке, массив в куче
        
        System.out.println(primitive); // 10
        System.out.println(reference); // Test
        System.out.println(array[0]);  // 0 (по умолчанию)
    }
}
```

- `primitive` — 4 байта в стеке со значением 10.
- `reference` — ссылка в стеке, указывающая на объект `String` в куче.
- `array` — ссылка в стеке, указывающая на массив из 3 элементов в куче.

---
### Дополнительные нюансы

1. **Пул строк (String Pool)**: Строки, созданные как литералы (например, `"Hello"`), хранятся в специальной области кучи — пуле строк, для экономии памяти.
2. **Автоупаковка (Autoboxing)**: Примитивы могут автоматически преобразовываться в объекты-обёртки (например, `int` в `Integer`), которые являются ссылочными типами и хранятся в куче.
3. **Сборщик мусора**: Объекты в куче, на которые больше нет ссылок, удаляются сборщиком мусора, тогда как стек очищается автоматически при выходе из метода.

---

Таким образом, примитивные типы — это простые значения с прямым хранением, а ссылочные типы — это указатели на сложные структуры в куче. Понимание их различий важно для оптимизации памяти и производительности в Java.

-----
**Zero-Links**  (Внутренние ссылки) Линки - ключевые слова
-

------
**Links** (Внешние ссылки)
-
