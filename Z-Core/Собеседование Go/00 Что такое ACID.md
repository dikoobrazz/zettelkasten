2025022423:21
___
Date: 24-02-2025 | 23:21
Tags: #
mapofcontents: [[zero-links|OO Links]]
___
## ACID

**ACID** — это акроним, обозначающий четыре ключевых свойства транзакций в системах управления базами данных (СУБД). Эти свойства обеспечивают надежность и целостность данных при выполнении операций, особенно в конкурентной среде. Давайте разберем каждое из них подробно:

### Что такое ACID?
  
1. **Atomicity (Атомарность)**
    - **Что это?** Гарантирует, что транзакция выполняется полностью или не выполняется вовсе. Если хотя бы одна часть транзакции (например, запись в базу) не удалась, все изменения откатываются (rollback).
    - **Пример**: Перевод денег между счетами. Снимаем 100 рублей с одного счета и добавляем их на другой. Если списание удалось, а зачисление нет, оба действия отменяются.
    - **Зачем?** Чтобы избежать частичного выполнения, которое может привести к некорректным данным.
2. **Consistency (Согласованность)**
    - **Что это?** После завершения транзакции база данных переходит из одного согласованного состояния в другое. Все правила, ограничения (constraints), ключи и зависимости остаются в силе.
    - **Пример**: Если в таблице есть ограничение "баланс >= 0", транзакция не может снять больше денег, чем есть на счете.
    - **Зачем?** Чтобы данные всегда соответствовали заданным правилам и логике приложения.
3. **Isolation (Изоляция)**
    - **Что это?** Транзакции изолированы друг от друга. Незавершенные изменения одной транзакции не видны другим транзакциям до её завершения (commit).
    - **Пример**: Если одна транзакция снимает деньги со счета, другая транзакция не увидит промежуточное состояние счета до завершения первой.
    - **Зачем?** Чтобы избежать проблем вроде "грязного чтения" (dirty read) или "фантомного чтения" (phantom read) в конкурентных операциях.
4. **Durability (Долговечность)**
    - **Что это?** После успешного завершения транзакции (commit) все изменения сохраняются в базе данных даже в случае сбоя системы (например, отключения питания).
    - **Пример**: После перевода денег и подтверждения транзакции данные записываются на диск, и даже сбой сервера не потеряет их.
    - **Зачем?** Чтобы гарантировать, что данные не исчезнут после успешной операции.

### Как это связано с Go?

В контексте разработки на Go, если вы пишете приложение, работающее с базой данных (например, через **database/sql** с PostgreSQL или MySQL), понимание ACID помогает:

- **Выбирать базу данных**: Реляционные базы (PostgreSQL, MySQL) обеспечивают ACID "из коробки", а NoSQL (MongoDB, Redis) могут жертвовать некоторыми свойствами ради производительности.
- **Реализовывать транзакции**: В Go вы используете методы вроде **Begin()**, **Commit()**, **Rollback()** для управления транзакциями.

**Пример транзакции в Go**
```go
package main

import (
    "database/sql"
    "fmt"
    _ "github.com/lib/pq" // Драйвер PostgreSQL
)

func transferMoney(db *sql.DB, fromID, toID, amount int) error {
    tx, err := db.Begin() // Начинаем транзакцию
    if err != nil {
        return err
    }
    defer tx.Rollback() // Откатываем, если что-то пойдет не так

    // Снимаем деньги с одного счета
    _, err = tx.Exec("UPDATE accounts SET balance = balance - $1 WHERE id = $2", amount, fromID)
    if err != nil {
        return err
    }

    // Добавляем деньги на другой счет
    _, err = tx.Exec("UPDATE accounts SET balance = balance + $1 WHERE id = $2", amount, toID)
    if err != nil {
        return err
    }

    // Подтверждаем транзакцию
    return tx.Commit()
}

func main() {
    db, err := sql.Open("postgres", "user=pguser dbname=test sslmode=disable")
    if err != nil {
        fmt.Println("Ошибка подключения:", err)
        return
    }
    defer db.Close()

    err = transferMoney(db, 1, 2, 100)
    if err != nil {
        fmt.Println("Ошибка перевода:", err)
    } else {
        fmt.Println("Перевод успешен")
    }
}
```

### Как работает ACID здесь?

- **Atomicity**: Если одно из обновлений (**UPDATE**) не удалось, **Rollback()** отменяет все изменения.
- **Consistency**: База проверяет ограничения (например, **balance >= 0**).
- **Isolation**: Другие транзакции не видят промежуточных изменений до **Commit()**.
- **Durability**: После **Commit()** изменения записываются на диск.
  
### Зачем это важно для Middle Go Developer?

- **Проектирование систем**: Понимание ACID помогает выбирать правильные инструменты (реляционные или NoSQL базы) и проектировать надежные приложения.
- **Обработка ошибок**: Вы можете грамотно управлять транзакциями, избегая несогласованности данных.
- **Конкурентность**: В сочетании с горутинами и каналами, знание изоляции помогает избежать race conditions на уровне базы.

> **ACID** — это фундамент надежности данных.


-----
**Zero-Links**  (Внутренние ссылки) Линки - ключевые слова
-

------
**Links** (Внешние ссылки)
-
