2025022502:06
___
Date: 25-02-2025 | 02:06
Tags: #
mapofcontents: [[zero-links|OO Links]]
___
## Какие http методы бывают?

В протоколе HTTP (HyperText Transfer Protocol) существует несколько методов (или "глаголов"), которые определяют, какое действие клиент хочет выполнить с ресурсом на сервере. Эти методы стандартизированы в спецификациях HTTP (например, RFC 7231) и широко используются в веб-разработке, включая REST API. Давайте разберем основные HTTP-методы, их назначение и особенности.

---
### Основные HTTP-методы

1. **GET**
    - **Назначение**: Запрашивает данные с сервера. Используется для получения ресурса без изменения его состояния.
    - **Особенности**:  
        - Безопасный (safe): Не изменяет данные на сервере.
        - Идемпотентный: Повторные запросы дают тот же результат.
        - Данные передаются в URL (query string), например: `/users?id=1`.      
    - **Пример**: Получение списка пользователей: `GET /api/users`.
      
2. **POST**
    - **Назначение**: Отправляет данные на сервер для создания нового ресурса или выполнения действия.
    - **Особенности**:  
        - Небезопасный: Изменяет состояние сервера.
        - Не идемпотентный: Повторные запросы могут создавать дубли (например, несколько заказов).
        - Данные передаются в теле запроса (body), часто в формате JSON.
    - **Пример**: Создание пользователя: `POST /api/users` с телом 
	    `{"name": "Alice", "email": "alice@example.com"}`.
      
3. **PUT**
    - **Назначение**: Обновляет существующий ресурс или создает его, если он не существует (с указанием конкретного идентификатора).
    - **Особенности**:  
        - Небезопасный: Изменяет данные.
        - Идемпотентный: Повторные запросы не меняют результат (обновление одного и того же ресурса).
        - Данные в теле запроса.
    - **Пример**: Обновление пользователя: `PUT /api/users/1` с телом 
	    `{"name": "Alice Updated"}`.
  
4. **DELETE**
    - **Назначение**: Удаляет указанный ресурс.
    - **Особенности**:  
        - Небезопасный: Изменяет состояние сервера.
        - Идемпотентный: Повторные запросы не меняют результат (ресурс уже удален)
    - **Пример**: Удаление пользователя: `DELETE /api/users/1`.
  
5. **PATCH**
    - **Назначение**: Частично обновляет ресурс (в отличие от PUT, который заменяет весь ресурс).
    - **Особенности**:  
        - Небезопасный: Изменяет данные.
        - Не всегда идемпотентный (зависит от реализации).
        - Данные в теле запроса, часто минимальные изменения.
    - **Пример**: Изменение email пользователя: `PATCH /api/users/1` с телом 
	    `{"email": "newemail@example.com"}`.
      
6. **HEAD**
    - **Назначение**: Аналогичен GET, но возвращает только заголовки ответа без тела.
    - **Особенности**:  
        - Безопасный и идемпотентный.
        - Используется для проверки метаданных (например, существует ли ресурс, его размер)
    - **Пример**: Проверка ресурса: `HEAD /api/users/1`.
      
7. **OPTIONS**
    - **Назначение**: Запрашивает доступные методы и возможности ресурса (используется для CORS или самодокументации API).
    - **Особенности**:  
        - Безопасный и идемпотентный.
        - Возвращает заголовок `Allow` с поддерживаемыми методами.
    - **Пример**: `OPTIONS /api/users` → `Allow: GET, POST, OPTIONS`.
      
8. **TRACE**
    - **Назначение**: Возвращает запрос обратно клиенту для диагностики (эхо).
    - **Особенности**:  
        - Безопасный и идемпотентный.
        - Редко используется из-за уязвимостей (например, XST — Cross-Site Tracing).
    - **Пример**: `TRACE /api/test`.
      
9. **CONNECT**
    - **Назначение**: Устанавливает туннель к серверу (обычно для HTTPS через прокси).
    - **Особенности**:  
        - Небезопасный.
        - Используется редко в обычных API, чаще в сетевых прокси.
    - **Пример**: `CONNECT example.com:443`.

---
### Дополнительные понятия

- **Безопасность (Safe)**: Метод не изменяет состояние сервера (GET, HEAD, OPTIONS).
- **Идемпотентность**: Повторные выполнения метода дают тот же результат (GET, PUT, DELETE, HEAD, OPTIONS).
- **Кэшируемость**: Некоторые методы (GET, HEAD) могут кэшироваться браузером или прокси

---
### Как это выглядит в Go?

В Go обработка HTTP-методов реализуется через пакет net/http. Пример простого сервера:
```go
package main

import (
    "fmt"
    "net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
    switch r.Method {
    case http.MethodGet:
        fmt.Fprintf(w, "Получение данных\n")
    case http.MethodPost:
        fmt.Fprintf(w, "Создание ресурса\n")
    case http.MethodPut:
        fmt.Fprintf(w, "Обновление ресурса\n")
    case http.MethodDelete:
        fmt.Fprintf(w, "Удаление ресурса\n")
    default:
        http.Error(w, "Метод не поддерживается", http.StatusMethodNotAllowed)
    }
}

func main() {
    http.HandleFunc("/api/resource", handler)
    fmt.Println("Сервер запущен на :8080")
    http.ListenAndServe(":8080", nil)
}
```

- Клиент отправляет запрос, например, curl -X GET http://localhost:8080/api/resource.
- Сервер проверяет r.Method и отвечает соответствующим образом.

---
### Когда какие методы использовать?
  
- **GET**: Для получения данных (списки, детали объекта).
- **POST**: Для создания или сложных действий (например, отправка формы).
- **PUT**: Для полного обновления ресурса по ID.
- **PATCH**: Для частичного обновления.
- **DELETE**: Для удаления.
- **HEAD**: Для проверки метаданных (например, при кэшировании).
- **OPTIONS**: Для CORS или документации API.

### В контексте REST API

В RESTful сервисах методы привязаны к операциям CRUD:
- **Create**: POST
- **Read**: GET
- **Update**: PUT или PATCH
- **Delete**: DELETE
  
---
### Нюансы в продакшене

- **Безопасность**: Ограничивайте методы (например, через `Allow` в заголовках).
- **CORS**: Браузеры отправляют `OPTIONS` перед некоторыми запросами.
- **Ошибки**: Возвращайте `405 Method Not Allowed`, если метод не поддерживается.

Эти методы — основа взаимодействия в вебе.

-----
**Zero-Links**  (Внутренние ссылки) Линки - ключевые слова
-

------
**Links** (Внешние ссылки)
-
