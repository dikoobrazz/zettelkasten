2025032018:07
___
Date: 20-03-2025 | 18:07
Tags: #
mapofcontents: [[zero-links|OO Links]]
___
### Задача: 
Реализовать простой HTTP сервер для управления пользователями на языке Go

Основная логика приложения - создание пользователя, который выполняет какие-либо целевые действия, например, вводит реферальный код, подписывается на телеграм канал или твиттер и получает за это награду в виде поинтов. Награду за каждое задание вы можете определить самостоятельно, также вы можете добавить другие задачи, дайте волю фантазии
### Нужно реализовать следующий функционал:

1. Middleware авторизация по Access token ко всем эндпоинтам (например JWT)
2. Реализация HTTP API:
	- GET /users/{id}/status - вся доступная информация о пользователе
	- GET /users/leaderboard - топ пользователей с самым большим балансом
	- POST /users/{id}/task/complete - выполнение задания 
	- POST /users/{id}/referrer - ввод реферального кода (может быть id другого пользователя)
3. Создание хранилища для всех этих данных по пользователю (postgres). Обязательно использование инструментов для миграций (golang-migrate)
4. Сборка всего проекта в docker-compose
    
### Дополнительные требования:
- Использовать последнюю версию языка Go
- Соблюсти структуру проекта (распределить код по соответствующим папкам, файлам) 
	best practicie for Go code.
- Прокинуть логи, обработку ошибок.
- Используем context там, где он не обходим.
- Обеспечить gracefull shutdown
- Используем interfaces для работы с базой данных и тому подобное.
- Написать тесты на код. 
- Протестировать все указанные маршруты (точки api).
- Обеспечить обработку ошибок и валидацию (например, неверные данные, несуществующие пользователи и т.д.)
- Придерживаться принципам SOLID и собдюдать чистоту кода

### **План разработки**

1. **Подготовка структуры проекта**
    - Используем best practices по организации кода (cmd, internal, pkg и т. д.)
    - Настраиваем `docker-compose`
    - Определяем модели данных
    
2. **Настройка базы данных (PostgreSQL) и миграции**
    - Используем `golang-migrate`
    - Создаём таблицы пользователей, заданий и реферальных связей
    
3. **Реализация API**
	- Описываем API
    - Аутентификация через JWT (middleware)
    - Эндпоинты:
        - Получение информации о пользователе
        - Лидерборд
        - Завершение задания
        - Ввод реферального кода
        
5. **Логирование, обработка ошибок, context**
    - Используем `log/slog`
    - Добавляем `context.Context` для всех запросов
    
6. **Graceful Shutdown**
    - Корректное закрытие соединений и завершение работы сервера
    
7. **Тестирование**
    - Юнит-тесты
    - Интеграционные тесты API


-----
**Zero-Links**  (Внутренние ссылки) Линки - ключевые слова
-

------
**Links** (Внешние ссылки)
-
